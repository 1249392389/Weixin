<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>二维码离线扫描程序</title>
</head>
<body style="text-align:center">
    <div>
        <h2>二维码离线扫描程序</h2>
        <input type="button" value="扫防护码" id="scancodeBtnOne" />
        <input type="button" value="扫防化码" id="scancodeBtnTwo" />
    </div>
    <div>
        <table border="1" width="100%">
            <thead>
                <tr>
                    <td>二维码值</td>
                    <td>扫码时间</td>
                    <td>查询</td>
                    <td>删除</td>
                </tr>
            </thead>
        </table>
        <input type="text" id="txtOne" />
    </div>
    <script src="~/Scripts/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.1.0.js"></script>
    <script type="text/javascript">
        $(function () {
            var appid=@ViewBag.appid;
            var timestamp=@ViewBag.timestamp;
            var noncestr=@ViewBag.noncestr;
            var signature=@ViewBag.signature;
            //注入配置信息
            wx.config({
                debug: true,//开启调试模式，调试所有api的返回值会在客户端alert出来
                appId: appid,//公众号的唯一标识
                timestamp: timestamp,//生成签名时的时间戳
                nonceStr: noncestr,//生成签名时的随机字符串
                signature: signature,//签名
                jsApiList: ['scanQRCode']//需要使用的JS接口列表
            });
        });
        $("#scancodeBtnOne").click(function(){
            wx.scanQRCode({
                needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，
                scanType: ["qrCode", "barCode"], // 可以指定扫二维码还是一维码，默认二者都有
                success: function (res) {
                    var result = res.resultStr; // 当needResult 为 1 时，扫码返回的结果
                    $("#txtOne").val(result);
                }

            });
        });
    </script>
</body>
</html>
